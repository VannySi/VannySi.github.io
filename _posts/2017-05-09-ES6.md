---
layout: post
title:  "ES6学习笔记"
date:   2017-05-09 19:14:23
author: Vanny
categories: Note
tags: Web
excerpt: ES6学习笔记，持续整理中
---

* content
{:toc}

## let与var
- 同一个作用域里，如果命名重复的话，var后者会覆盖掉前者，而let会报错 
    
```js
// var直接覆盖
var temp = 1;
console.log(temp);
var temp = 2;
console.log(temp);
// let报错
let temp = 1;
console.log(temp);
let temp = 2;
console.log(temp);
```

- var只有全局作用域和函数作用域，let相较于var增加了块作用域

```js
var name1 = 'aaaaa';
while (true) {
	var name1 = 'bbbbb';
	console.log(name1); 
	break;
}
console.log(name1);
let name2 = 'aaaaa';
while (true) {
	let name2 = 'bbbbb';
	console.log(name2); 
	break;
}
console.log(name2)
```

- let解决了var的变量泄露问题，var一般使用闭包来解决这个问题

```js
var a1 = [];
for (var i = 0; i < 10; i++) {
	a1[i] = function () {
		console.log(i);
	};
}
a1[6](); a1[3](); 
let a2 = [];
for (let i = 0; i < 10; i++) {
	a2[i] = function () {
		console.log(i);
	};
}
a2[6](); a2[3]();
```

## const
- 同一个作用域里，如果命名重复的话会报错，不同作用域里会不影响

```js
for(var i = 0; i < 2; i++){
    const PI = Math.PI; 
    console.log(PI);
}
const PI = 3.14;
console.log(PI);
```

- const定义常量，值不能改变

```js
const PI = Math.PI;
PI = 23;
```

- const允许变量赋值

```js
let te1 = 1;
const text = te1;
console.log(text);
te1 = 2;
console.log(text);
```
- const的实际用途

```js
// 定义常量
const PI = Math.PI;
// 定义函数
const fun1 = () => {
	...
}
// 命名空间
const GLOBAL = {}
GLOBAL.namespace = function (str) {
        var arr = str.split('.'),
	o = GLOBAL;
	for(let i = (arr[0] === 'GLOBAL') ? 1 : 0; i < arr.length; i++){
	        o[arr[i]] = o[arr[i]] || {};
	        o = o[arr[i]];
	}
};
```

## class, extends, super
```js
function Point(x, y) {
    this.x = x;
    this.y = y;
}
Point.prototype.toString = function () {
    return '(' + this.x + ', ' + this.y + ')';
};
var p = new Point(1, 2);
//定义类
class Point {
    constructor(x, y) {    //constructor 构造方法
        this.x = x;
        this.y = y;
    }
    toString() {
        return '(' + this.x + ', ' + this.y + ')';
    }
}
var p = new Point(1, 2);
```

## arrow function
- 简化代码，指向使用时所在的对象。
 
```js
function test1(x, y) { 
	x++;
	y--;
	return x + y;
}
const test2 = (x, y) => {
	x++; 
	y--; 
	return x+y
}
```

- 实例

```html
<div class="red">
	<div class="blue">
	</div>
</div>
<script type="text/javascript">
	$('.red').on('click', clickEvent);
	function clickEvent(){
		var that = this;
		//$(this).text();
		console.log(this);
		// $(this).text('被点击了');
		setTimeout(function(){
			$(that).text('被点击了');
			console.log(this);
		}, 1000);
		setTimeout(() => {
		 	$(this).text('被点击了');
		 	console.log(this);
		}, 1000);
	}
	// function clickEvent(){
	// 	var that = this;
	// 	console.log(this);
	// 	changeEvent();
	// 	function changeEvent(){
	// 		console.log(this);
	// 		$(that).find('.blue').css('background-color', 'yellow');
	// 	}
	// 	const changeEvent = () => {
	// 		$(this).find('.blue').css('background-color', 'yellow');
	// 	}
	// }
</script>
```

## template string
```html
<div id="result1"></div>
<div id="result2"></div>
```
```js
let basket = {
	count: 5,
	onSale: 4
};
$("#result1").append(
	"There are <b>" + basket.count + "</b> " +
	"items in your basket, " +
	"<em>" + basket.onSale +
	"</em> are on sale!"
);
$("#result2").append(`
	template string:
	There are <b>${basket.count}</b> items
	in your basket, <em>${basket.onSale}</em>
	are on sale!
`);
className="";
className={`class1 clsaa2`};
```

## destructuring
简化代码
```js
let cat = '喵喵';
let dog = '旺财';
let zoo1 = {cat: cat, dog: dog};
console.log(zoo1); 
let zoo2 = {cat, dog};
console.log(zoo2);
let dog1 = {type: 'animal', many: 2};
let { type, many} = dog1;
console.log(type, many);
```

## default，rest
```js
function todo(type = 'cat', b , ...arg){
	console.log(type, b, arg);
}
todo(undefined, '123', [1,2,3], 12);
```

## forEach
简化代码，但是不能在`forEach`中使用`break`、`continue`、`return`关键字
```js
let arr = ['1', '2', '3'];
arr.forEach(function(val){
    console.log(val);
});
```

## for-in与for-of
`for-in`是为普通对象设计的，适用于遍历得到字符串类型或者对象的键，而不适用于数组遍历。
在使用`for-in`遍历数组时会出现以下问题：  
1. `for(let k in arr)` 中`k`的值不是数字而是字符串"0"、"1"、"2"
2. `for-in`循环体除了遍历数组元素外，还会遍历自定义属性，甚至连数组原型链上的属性都能被访问到
3. 在某些情况下，`for-in`可能按照随机顺序遍历数组元素 

由于在使用`for-in`遍历数组会出现一些问题，所以`ES6`增加了`for-of`： 语法简洁，修复`for-in`的问题，可以使用`break`、`continue`、`return`关键字(相比于`forEach`)
```js
let arr = ['1', '2', '3'];
for(let i of arr){
	console.log(i);
}
```

- 支持遍历DOM NodeList(`for-in`遍历得到的并不是子节点)

```html
<div id="parent">
	<span>1</span>
	<span>2</span>
	<span>3</span>
	<span>4</span>
	<span>5</span>
</div>
<script>
	let parent = document.getElementById('parent');
	let child_nodes = parent.childNodes;
	for(let node of child_nodes){  
		console.log(node);
	}
	// 相当于
	for(let i = 0; i < child_nodes.length; i++){
		console.log(child_nodes[i]);
	}
</script>
```

- 支持字符串的遍历，会把字符串作为一组 Unicode 的字符进行遍历(`for-in`也可以做到)
```js
for (var ch of "123") {
	console.log(ch);
}
```

- 还支持应用于 Map 和 Set 对象(Map 和 Set 对象还没研究，暂搁)

-  **注意：** `for-of`并不适用于处理原有的原生对象(包括`JSON`对象)，处理原有的原生对象时可以使用`for-in`或者内置的`Object.keys()`
```js
let obj = {
	name: '张三',
	age: 12
}
for(let key in obj){
    console.log(key, obj[key]);
}
for (var key of Object.keys(obj)) {
  console.log(key, obj[key]);
}
```